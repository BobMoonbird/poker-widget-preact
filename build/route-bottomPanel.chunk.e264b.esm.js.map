{"version":3,"sources":["webpack:///./components/Controls/index.js","webpack:///../node_modules/process/browser.js","webpack:///./utils/metadata.js","webpack:///./utils/getCards.js","webpack:///./routes/bottomPanel/index.js","webpack:///./utils/getCardURL.js","webpack:///./components/Controls/style.less","webpack:///./appconstants/index.js"],"names":["Controls","Component","handleReveal","async","this","props","onBeforeReveal","event","updates","getCards","filter","widget","getMetadata","side","map","id","value","metadata","updateMetadata","url","getCardURL","miro","board","widgets","update","onReveal","handleClear","onBeforeClear","allCardIds","type","deleted","deleteById","console","log","length","onClear","render","class","style","wrapper","onClick","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","setTimeout","e","call","cleanUpNextTick","draining","currentQueue","queue","concat","queueIndex","drainQueue","timeout","len","run","marker","cachedClearTimeout","clearTimeout","runClearTimeout","Item","array","noop","process","module","exports","nextTick","args","Array","arguments","i","push","prototype","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","umask","appId","APP_ID","nextMetadata","get","Sidebar","state","time","sidebar","window","location","origin","CARDS_BACK_INDEXES","CARDS_LIST","label","CARDS_MAP","reduce","acc","item"],"mappings":"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","file":"route-bottomPanel.chunk.e264b.esm.js","sourcesContent":["import { h, Component } from 'preact';\r\nimport style from './style';\r\nimport getCards from 'utils/getCards';\r\nimport { getMetadata, updateMetadata } from 'utils/metadata';\r\nimport getCardURL from 'utils/getCardURL';\r\n\r\nclass Controls extends Component {\r\n\thandleReveal = async event => {\r\n\t\tif (typeof this.props.onBeforeReveal === 'function') {\r\n\t\t\tthis.props.onBeforeReveal(event);\r\n\t\t}\r\n\t\tconst cards = await getCards();\r\n\r\n\t\tconst backCards = cards.filter(\r\n\t\t\twidget => getMetadata(widget).side === 'back'\r\n\t\t);\r\n\r\n\t\tconst updates = backCards.map(widget => {\r\n\t\t\tconst { id } = widget;\r\n\t\t\tconst { value } = getMetadata(widget);\r\n\t\t\treturn {\r\n\t\t\t\tid,\r\n\t\t\t\tmetadata: updateMetadata(widget, {\r\n\t\t\t\t\tside: 'face',\r\n\t\t\t\t}),\r\n\t\t\t\turl: getCardURL('face', value),\r\n\t\t\t};\r\n\t\t});\r\n\t\tawait miro.board.widgets.update(updates);\r\n\t\tif (typeof this.props.onReveal === 'function') {\r\n\t\t\tthis.props.onReveal();\r\n\t\t}\r\n\t};\r\n\r\n\thandleClear = async event => {\r\n\t\tif (typeof this.props.onBeforeClear === 'function') {\r\n\t\t\tthis.props.onBeforeClear(event);\r\n\t\t}\r\n\r\n\t\tconst cards = await getCards();\r\n\r\n\t\tconst allCardIds = cards\r\n\t\t\t.filter(widget => getMetadata(widget).type === 'card')\r\n\t\t\t.map(widget => widget.id);\r\n\r\n\t\tconst deleted = miro.board.widgets.deleteById(allCardIds);\r\n\r\n\t\t// eslint-disable-next-line no-console\r\n\t\tconsole.log('deleted', deleted.length, 'cards');\r\n\t\tif (typeof this.props.onClear === 'function') {\r\n\t\t\tthis.props.onClear();\r\n\t\t}\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<nav class={style.wrapper}>\r\n\t\t\t\t<button\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tclass=\"miro-btn miro-btn--primary miro-btn--small\"\r\n\t\t\t\t\tonClick={this.handleReveal}\r\n\t\t\t\t>\r\n\t\t\t\t\tReveal all\r\n\t\t\t\t</button>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\"miro-btn miro-btn--secondary miro-btn--small\"\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tonClick={this.handleClear}\r\n\t\t\t\t>\r\n\t\t\t\t\tClear all\r\n\t\t\t\t</button>\r\n\t\t\t</nav>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Controls;\r\n\r\n/*\r\nconst roundResults = backCards =>\r\n\tbackCards.reduce((acc, widget) => {\r\n\t\tconst { value } = getMetadata(widget);\r\n\t\tif (value in acc) {\r\n\t\t\tacc[value]++;\r\n\t\t} else {\r\n\t\t\tacc[value] = 1;\r\n\t\t}\r\n\r\n\t\treturn acc;\r\n\t}, {});\r\n\r\nconst resultShapePoint = backCards =>\r\n\tbackCards.reduce(\r\n\t\t(acc, widget, index, { length }) => {\r\n\t\t\tacc.x = acc.x + widget.x / length;\r\n\t\t\tacc.y = Math.max(acc.y, widget.y);\r\n\t\t\treturn acc;\r\n\t\t},\r\n\t\t{ x: 0, y: 0 }\r\n\t);\r\n\r\n\t*/\r\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","import { APP_ID } from 'appconstants';\r\n\r\nexport const getMetadata = (widget, appId = APP_ID) => {\r\n\tif (!appId) {\r\n\t\tthrow new Error('No appId specified');\r\n\t}\r\n\treturn widget.metadata[appId] || {};\r\n};\r\nexport const updateMetadata = (widget, nextMetadata, appId = APP_ID) => ({\r\n\t...widget.metadata,\r\n\t[appId]: {\r\n\t\t...widget.metadata[appId],\r\n\t\t...nextMetadata,\r\n\t},\r\n});\r\n\r\nexport const setMetadata = (widget, nextMetadata, appId = APP_ID) => ({\r\n\t...widget.metadata,\r\n\t[appId]: nextMetadata,\r\n});\r\n","import { getMetadata } from './metadata';\r\n\r\nexport default async function getCards() {\r\n\tconst widgets = await miro.board.widgets.get();\r\n\treturn widgets.filter(widget => getMetadata(widget).type === 'card');\r\n}\r\n","import { h, Component } from 'preact';\r\nimport style from './style';\r\nimport Controls from '../../components/Controls';\r\n\r\nexport default class Sidebar extends Component {\r\n\tstate = {\r\n\t\ttime: 1,\r\n\t};\r\n\r\n\t// Note: `user` comes from the URL, courtesy of our router\r\n\trender({ user }, { time, count }) {\r\n\t\treturn (\r\n\t\t\t<div class={style.sidebar}>\r\n\t\t\t\t<Controls />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","const { BASE_URL } = process.env;\r\n\r\nexport default (side, value = '') =>\r\n\t`${window.location.origin}/assets/cards/${side}${value}.svg`;\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"wrapper__18AHL\"};","export const APP_ID = '3074457347007443177';\r\n\r\n// eslint-disable-next-line no-magic-numbers\r\nexport const CARDS_BACK_INDEXES = [1, 2, 3, 4, 5, 6];\r\n\r\nexport const CARDS_LIST = [\r\n\t{\r\n\t\tlabel: '0',\r\n\t\tvalue: 0,\r\n\t},\r\n\t{\r\n\t\tlabel: '½',\r\n\t\tvalue: 0.5,\r\n\t},\r\n\t{\r\n\t\tlabel: '1',\r\n\t\tvalue: 1,\r\n\t},\r\n\t{\r\n\t\tlabel: '2',\r\n\t\tvalue: 2,\r\n\t},\r\n\t{\r\n\t\tlabel: '3',\r\n\t\tvalue: 3,\r\n\t},\r\n\t{\r\n\t\tlabel: '5',\r\n\t\tvalue: 5,\r\n\t},\r\n\t{\r\n\t\tlabel: '8',\r\n\t\tvalue: 8,\r\n\t},\r\n\t{\r\n\t\tlabel: '13',\r\n\t\tvalue: 13,\r\n\t},\r\n\t{\r\n\t\tlabel: '20',\r\n\t\tvalue: 20,\r\n\t},\r\n\t{\r\n\t\tlabel: '40',\r\n\t\tvalue: 40,\r\n\t},\r\n\t{\r\n\t\tlabel: '100',\r\n\t\tvalue: 100,\r\n\t},\r\n\t{\r\n\t\tlabel: '∞',\r\n\t\tvalue: 'infinity',\r\n\t},\r\n\t{\r\n\t\tlabel: '?',\r\n\t\tvalue: 'question',\r\n\t},\r\n\t{\r\n\t\tlabel: '☕',\r\n\t\tvalue: 'coffee',\r\n\t},\r\n];\r\n\r\nexport const CARDS_MAP = CARDS_LIST.reduce((acc, item) => {\r\n\tacc[item.value] = item;\r\n\treturn acc;\r\n}, {});\r\n"],"sourceRoot":""}